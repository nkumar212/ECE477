<html>
<head>

<link rel="stylesheet" type="text/css" href="index.css"/>

<script>

//Constants
var KEY_W = 1;
var KEY_A = 2;
var KEY_S = 4;
var KEY_D = 8;
var KEY_SPACE = 16;

var ws = new WebSocket("ws://128.46.100.114:9999/");

//Global variable holding which gKeys are down
var gKeys = 0;
var msgInfo = new Object();

ws.onopen = function() {

	ws.send('Hello from the client!');
	
	document = document.getElementById("canvas");
	output = document.getElementById("output");

	document.onload = function(){
		gKeys = 0;
	}

	document.onfocus = function(){
		gKeys = 0;
	}

	document.onblur = function(){
		gKeys = 0;
	}

	document.onkeyup = function(e){
		if(e == null) e = window.event;
		key = e.keyCode;

		if(key == 65) //A
			gKeys &= 0xFFFF ^ KEY_A
		else if(key == 83) //S
			gKeys &= 0xFFFF ^ KEY_S
		else if(key == 68) //D
			gKeys &= 0xFFFF ^ KEY_D
		else if(key == 87) //W
			gKeys &= 0xFFFF ^ KEY_W
		else if(key == 32) //Space
			gKeys &= 0xFFFF ^ KEY_SPACE
	}

	document.onkeydown = function(e){
		if(e == null) e = window.event;
		key = e.keyCode;

		if(key == 65) //A
			gKeys |= KEY_A
		else if(key == 83) //S
			gKeys |= KEY_S
		else if(key == 68) //D
			gKeys |= KEY_D
		else if(key == 87) //W
			gKeys |= KEY_W
		else if(key == 32) //Space
			gKeys |= KEY_SPACE
	}

	function getKeys(){
		setTimeout(function() {
			msgInfo.command=document.getElementById("command").value;
			msgInfo.gKeys=gKeys;
			msgInfo.speed=document.getElementById("speedslider").value;
			msgInfo.robotid=document.getElementById("username").value;
			msgInfo.sessionid=document.getElementById("sessionid").value;

			msg = JSON.stringify(msgInfo);
			output.value = msg 
			ws.send(msg);
		
			getKeys();
		},10);
	}

	getKeys();
}

</script>
</head>
<body>
	<!--HEADER -->
	<div class="header">
	<h1 id="header_text">Project Minotaur Command and Control Page</h1>
	
	</div>

	<table id="main_section" cellpadding="15">
		<tr>
		<td id="settings_box">
			<table class="settings_table">
			<caption class="header">Robot Status and Settings</caption>
			<tr>
					<td class="label">Status</td>
					<td class="value"><span id="status" style="color:red">Offline</span></td>
			</tr>
			<tr>
					<td class="label">Battery Percentage</td>
					<td class="value"><span id="status" style="color:green">100%</span></td>
			</tr>
					<tr>
					<td class="label">Speed</td>
					<td class="value"><span id="status" style="color:#008080">1 m/s</span></td>
			</tr>	
			
			<tr><td colspan="2">----------------------------------------------------------------</td></tr>

			<tr>


					<td class="label">Email To Alert</td>
					<td class="value"><input type="text" name="email"></td>
			</tr>		<tr>
					<td class="label">Camera Mode</td>
					<td class="value"><form action="">
							<input type="radio" name="camera_mode" value="color">Color</input>
							<input type="radio" name="camera_mode" value="IR">IR</input></form>
					</td>
			</tr>
			<tr>
					<td class="label">Drive Mode</td>
					<td class="value"><form action="">
							<input type="radio" name="drive_mode" value="patrol">Patrol</input>
							<input type="radio" name="drive_mode" value="manual">Manual</input></form>
					</td>
			</tr>
			<tr>
					<td></td>
					<td class="value"><input type="button" value="Save Settings"/></td>
			</tr>	

			</table>
			
		</td>

		<td id=video_stream">
			<!--
			<embed type="application/x-vlc-plugin" pluginspage="http://www.videolan.org" width="320" height="240" id="vlc" loop="yes" autoplay="yes" target="test.ogg"></embed>
			<object classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" codebase="http://download.videolan.org/pub/videolan/vlc/last/win32/axvlc.cab"></object>	
			-->
			<video id="video_stream" style="background-color:white;border: thin red solid;" width=320 height=240>
				<source src="rtp://128.46.100.114:50001/test1.ogg" type="video/ogg" />	
			</video>	
		</td>
		</tr>

		<tr>
			<td colspan="2" id="directions"><p>Welcome to the command and control page for Project Minotaur! Press the patrol button to have the robot automatically patrol the room and search for intruders. If it finds one the email specified will be alerted with a picture of the intruder. To drive the robot, press the 'Manual' radio button and use the following keys:
				   			<ul>
								<li>W          --- forward</li>
								<li>A          --- left</li>
								<li>S          --- backwards</li>
								<li>D          --- right</li>
								<li>Space      --- stop</li>
								<li>Up Arrow   --- speed up</li>
								<li>Down arrow --- slow down</li>
						</ul>
			</td>	
		</tr>

		<tr><!--
		<td colspan="2" id="button_box">
			<input class="command_button" type="button" width=70px height=40px value="Drive Robot"/>
			<input class="command_button" type="button" width=70px height=40px value="Patrol Room"/>
	</td>
	-->
		</tr>
	</table>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>
		<br>




		<canvas tabindex=1 style="background-color:white;border: thin red solid;" width=320 height=240 id="canvas"></canvas>
		<video id="video_stream" style="background-color:white;border: thin red solid;" width=320 height=240>
			<source src="rtp://128.46.100.114:50001/test1.ogg" type="video/ogg" />	
		</video>
		
		<input type="hidden" id="robotid" value="MINOTAUR_1" />
		<input type="hidden" id="sessionid" value="127.0.0.1" />
		<input type="hidden" id="command" value="0" />
		
		<br>Username:<input type="text" id="username"/>
		<br>Speed:<input type="range" id="speedslider" min="0" max="100"/>
		<br>Outdata:<textarea id="output" cols=80 rows=5></textarea>

	</div>
</body>
</html>

=======
<html>
<head>
<script>

//Constants
var KEY_W = 1;
var KEY_A = 2;
var KEY_S = 4;
var KEY_D = 8;
var KEY_SPACE = 16;

var ws = new WebSocket("ws://localhost:9999/");

//Global variable holding which gKeys are down
var gKeys = 0;
var msgInfo = new Object();

ws.onopen = function(){

	ws.send('Hello from the client!');
	
	canvas = document.getElementById("canvas");
	output = document.getElementById("output");

	canvas.onload = function(){
		gKeys = 0;
	}

	canvas.onfocus = function(){
		gKeys = 0;
	}

	canvas.onblur = function(){
		gKeys = 0;
	}

	canvas.onkeyup = function(e){
		if(e == null) e = window.event;
		key = e.keyCode;

		if(key == 65) //A
			gKeys &= 0xFFFF ^ KEY_A
		else if(key == 83) //S
			gKeys &= 0xFFFF ^ KEY_S
		else if(key == 68) //D
			gKeys &= 0xFFFF ^ KEY_D
		else if(key == 87) //W
			gKeys &= 0xFFFF ^ KEY_W
		else if(key == 32) //Space
			gKeys &= 0xFFFF ^ KEY_SPACE
		else if(key == 13)
			gKeys &= 0xFFFF ^ KEY_ENTER
	}

	canvas.onkeydown = function(e){
		if(e == null) e = window.event;
		key = e.keyCode;

		if(key == 65) //A
			gKeys |= KEY_A
		else if(key == 83) //S
			gKeys |= KEY_S
		else if(key == 68) //D
			gKeys |= KEY_D
		else if(key == 87) //W
			gKeys |= KEY_W
		else if(key == 32) //Space
			gKeys |= KEY_SPACE
		else if(key == 13)
			gKeys |= KEY_ENTER
	}

	function getKeys(){
		setTimeout(function() {
			msgInfo.command=document.getElementById("command").value;
			msgInfo.gKeys=gKeys;
			msgInfo.speed=document.getElementById("speedslider").value;
			msgInfo.robotid=document.getElementById("username").value;
			msgInfo.sessionid=document.getElementById("sessionid").value;

			msg = JSON.stringify(msgInfo);
			output.value = msg 
			ws.send(msg);
		
			getKeys();
		},10);
	}

	getKeys();
}

</script>
</head>
<body>
<canvas tabindex=1 style="background-color:white;border: thin red solid;" width=320 height=240 id="canvas"></canvas>
<video style="background-color:white;border: thin red solid;" width=320 height=240>
<source src="rtp://localhost:50001/test1.ogg" type="video/ogg" />
	
</video>
<input type="hidden" id="robotid" value="MINOTAUR_1" />
<input type="hidden" id="sessionid" value="127.0.0.1" />
<input type="hidden" id="command" value="0" />
<br>Username:<input type="text" id="username"/>
<br>Speed:<input type="range" id="speedslider" min="0" max="100"/>
<br>Outdata:<textarea id="output" cols=80 rows=5></textarea>
</body>
</html>
